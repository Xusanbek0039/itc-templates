function t_quiz__step_manager(t){var t,n=(t=t||{steps:[],activeStepClass:""}).steps,e=t.activeStepClass||"t-step-form__step_active",i=t.animation,a=t.enableConditionals,o=t.enableAutoStepChange,r=!1,s,u=300,c={index:-1,step:null};function l(t){t.element.classList.add(e)}function f(t){t.element.classList.remove(e)}function p(t){var n=t.element.querySelectorAll(".t-quiz__step__input"),e=n.length&&Array.from(n).every((function(t){return"true"===t.getAttribute("data-hidden-by-condition")}));return"true"===t.element.getAttribute("data-hidden-by-condition")||e}function m(){var t=n.findIndex((function(t,n){return n>c.index&&!p(t)})),e=Math.min(n.length,t);return{index:e,step:n[e]}}function d(){for(var t=c.index,e=-1===t?n.length-1:t-1,i=e;i>=0;i--){var a;if(!p(n[i])){e=i;break}}var o=Math.max(0,e);return{index:o,step:n[o]}}function v(t){return n.filter((function(n){return-1!==t.indexOf(n.type)&&!p(n)}))}function y(){var t=v(["step","contacts"]),n=t.indexOf(c.step);return{total:t.length,current:-1===n?null:n+1}}function g(t,n){var e=c.step,i="next"===t?m():d();c=i,x(e,i.step,(function(){n&&n()}))}function h(){var t=n.filter((function(t){return!p(t)})),e=t.indexOf(c.step),i,a;return t.splice(e+1).every((function(t){return"step"!==t.type&&"contacts"!==t.type}))}function _(){return{type:c.step?c.step.type:"finalResult",index:c.index,isFirst:0===c.index,isLast:h(),step:c.step}}function S(){var t=["ri","rd","rs","sb","cb"],e;n.filter((function(n){var e=n.element,i;if(!e.querySelector(".t-quiz__inputs-wrapper")){var a=e.querySelector(".t-input-group");return a&&-1!==t.indexOf(a.getAttribute("data-field-type"))}})).forEach((function(t){var n=Array.prototype.slice.call(t.element.querySelectorAll(".js-tilda-rule"));(n=n.filter((function(t){return!t.classList.contains("t-radio-ownanswer")}))).forEach((function(t){t.addEventListener("change",A)}))}))}function A(){var t=_();t.isLast||"finalResult"===t.type||r||(r=!0,s=setTimeout((function(){g("next")}),u))}function C(){o&&(clearTimeout(s),r=!1)}function x(n,a,o){var r=t,s=r.onStepChange,u=r.onProgressChange;if(!i)return n&&f(n),l(a),s&&s(a),u&&u(y()),o&&o(),void C();var c=i.callbacks||{},p=c.onAnimationComplete,m=c.onAnimationStart,d=c.onNewStepAnimationStart;t_quiz__animateSteps(n,a,{onAnimationStart:function t(n,e){m&&m(n,e)},onNewStepAnimationStart:function t(n,e){d&&d(n,e),s&&s(e),u&&u(y()),C()},onAnimationComplete:function t(n,e){p&&p(n,e),o&&o()}},{animation:{in:w(a),out:w(n)},stepActiveClass:e})}function w(t){return t&&"string"!=typeof i?i.type[t.type]||"fade-with-move":i}function L(){a?t_onFuncLoad("t_form__conditionals_initFields",(function(){var n=t_form__conditionals_initFields(t.recId);n.addListeners((function(){t.onProgressChange&&t.onProgressChange(y())})),n.addStateChangeListeners((function(n){t.onConditionalStateChange&&t.onConditionalStateChange(n)})),o&&S(),g("next",t.onInit)})):(o&&S(),g("next",t.onInit))}return{go:g,init:L,getStepsProgress:y,getCurrentStepInfo:_}}function t_quiz__animateSteps(t,n,e,i){var a=700,o=400,r="forwards",s="ease-in-out";if(n)return i=i||{animation:{in:"fade-with-move",out:"fade-with-move"}},n.element.animate?(e.onAnimationStart&&e.onAnimationStart(t,n),t?v():d()):(t&&t.element.classList.remove(i.stepActiveClass),void n.element.classList.add(i.stepActiveClass));function u(t){var n=t.animate([{opacity:0,pointerEvents:"none"},{opacity:1,pointerEvents:"auto"}],{duration:a,fill:r,easing:s});return n.pause(),n}function c(t){var n=t.animate([{transform:"translateY(15px)",opacity:0,pointerEvents:"none"},{transform:"translateY(0px)",opacity:1,pointerEvents:"auto"}],{duration:a,fill:r,easing:s});return n.pause(),n}function l(t){var n=t.animate([{opacity:1,pointerEvents:"none"},{opacity:0,pointerEvents:"auto"}],{duration:o,fill:r,easing:s});return n.pause(),n}function f(t){var n=t.animate([{transform:"translateY(0)",opacity:1,pointerEvents:"none"},{transform:"translateY(20px)",opacity:0,pointerEvents:"auto"}],{duration:o,fill:r,easing:s});return n.pause(),n}function p(){e.onAnimationComplete&&e.onAnimationComplete(t,n)}function m(){t.element.classList.remove(i.stepActiveClass),n&&d()}function d(){var a;(a="fade-with-move"===i.animation.in?c(n.element):u(n.element)).finished.then(p),n.element.classList.add(i.stepActiveClass),a.play(),e.onNewStepAnimationStart&&e.onNewStepAnimationStart(t,n)}function v(){var n;(n="fade-with-move"===i.animation.out?f(t.element):l(t.element)).finished.then(m),n.play()}}
