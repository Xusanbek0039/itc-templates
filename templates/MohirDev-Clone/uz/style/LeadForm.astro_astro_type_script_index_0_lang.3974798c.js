import{m as x}from"./hoisted.63d8ef3d.js";import{i as C,l as A,A as I}from"./leadRepository.aaa44935.js";import{P as L}from"./hoisted.0092494d.js";const N="6Lf0Q64fAAAAAN8yMaIh4wZmV4V6X3KH5cvldVxB",T="cdbf78f9e2a9c11f0a8bec5bc4d3ceda",E=Array.from(document.querySelectorAll(".lead-form"));let w=null;const b=t=>{const e=t.querySelector(".lead-form-contact-input"),n=t.querySelector(".lead-form-username-input"),s=t.querySelector(".lead-form-checkbox"),a=t.querySelector(".checkbox-icon"),r=t.querySelector(".check-icon"),d=t.querySelector(".lead-form-label"),c=t.querySelector(".lead-form-icon"),l=t.querySelector(".lead-form-spinner"),o=t.querySelector(".lead-form-submit-btn"),h=o.querySelector("p"),i=t.querySelector(".error-message"),u=t.querySelector(".phone-validation-error"),f=t.querySelector(".lead-form-name-input");return{contactInput:e,usernameInput:n,nameInput:f,checkbox:s,checkboxIcon:a,label:d,telegramIcon:c,spinner:l,leadSubmitBtn:o,checkIcon:r,errorMessage:i,leadSubmitBtnText:h,validateErrorMessage:u}};window.renderReCaptcha=function(){const t=document.createElement("div");t.classList.add("invisible-recaptcha");var e=document.body.appendChild(t),n=window.grecaptcha.render(e,{sitekey:N,badge:"badge",size:"invisible",callback:function(s){B(s,w)},"expired-callback":function(){window.grecaptcha.reset(n)}});E.forEach(s=>{s.onsubmit=function(a){a.preventDefault(),w=s,window.grecaptcha.execute(n)}})};function m(){var t=document.getElementsByTagName("head")[0],e=document.createElement("script");e.type="text/javascript",e.src="https://www.google.com/recaptcha/api.js?onload=renderReCaptcha&render=explicit",t.appendChild(e);const n=document.querySelectorAll(".lead-form-name-input"),s=document.querySelectorAll(".lead-form-contact-input");n.forEach(a=>a.removeEventListener("focus",m)),s.forEach(a=>a.removeEventListener("focus",m))}function q(t){const{spinner:e}=b(t);e.classList.remove("block"),e.classList.add("hidden")}function p(t){q(t);const{leadSubmitBtn:e,checkIcon:n}=b(t);e.disabled=!0,e.classList.add("opacity-40","bg-green-500","border-green-500","hover:bg-green-500","hover:border-green-500"),e.querySelector("p").textContent="Jo'natilgan",n.classList.add("block"),n.classList.remove("hidden")}function B(t,e){const n=e.dataset.productId,s=JSON.parse(window.sessionStorage.getItem("is_lead")||"false"),a=JSON.parse(sessionStorage.getItem("productIds")||"[]")||[],r=a.includes(n),d=window.location.search,{spinner:c,checkbox:l,contactInput:o,nameInput:h,leadSubmitBtn:i,leadSubmitBtnText:u,usernameInput:f,errorMessage:g,validateErrorMessage:v}=b(e);if(e.isSubmitting)return;if(n?r:s){p(e);return}if(C(o.value))v.classList.add("hidden");else{v.classList.remove("hidden"),o.focus();return}const S={fullName:h.value,captchaToken:t,needConsultation:!0,productType:n?L.Practicum:L.Course,productId:n};S.phone=o.value,S.telegramUsername=f.value,e.isSubmitting=!0,i.disabled=!0,c.classList.remove("hidden"),c.classList.add("block"),i.classList.add("opacity-40"),A.create(S,d).then(y=>{y.message==="LEAD_CREATED"?(n?(a?.push(n),window.sessionStorage.setItem("productIds",JSON.stringify(a)),p(e),u.textContent="Jo'natildi"):(window.sessionStorage.setItem("is_lead","true"),p(e),u.textContent="Jo'natildi"),g.classList.add("hidden")):(q(e),i.disabled=!1,i.classList.remove("opacity-40"),g.classList.remove("hidden"),g.classList.add("block"))}).finally(()=>{e.isSubmitting=!1,x.init(T,{loaded:function(y){y.track("Lead form submitted",{"Course Name":e.dataset.courseName,"Foreign Country Number":l.checked,"Location Type":e.dataset.locationType,pathname:window.location.pathname})}})})}function k(){const t=window.location.pathname==="/";E.forEach(e=>{const n=e.dataset.productId,s=JSON.parse(window.sessionStorage.getItem("is_lead")||"false"),r=(JSON.parse(sessionStorage.getItem("productIds")||"[]")||[]).includes(n),{leadSubmitBtn:d,contactInput:c,nameInput:l}=b(e);t&&s||r?p(e):d.disabled=!1,l.addEventListener("focus",m,!1),c.addEventListener("focus",m,!1),c.addEventListener("input",o=>{o.target.value.startsWith("+")?c.value=new I().input(o.target.value):c.value=new I().input("+"+o.target.value)})})}document.readyState!=="loading"?k():document.addEventListener("DOMContentLoaded",k);
